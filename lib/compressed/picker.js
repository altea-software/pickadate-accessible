/*!
 * Time picker for pickadate.js v3.6.4 - Versione Accessibile WCAG 2.1 AA
 * http://amsul.github.io/pickadate.js/time.htm
 * Modifiche per accessibilit√† WCAG 2.1 AA e strict equality
 */
!function(a){"function"==typeof define&&define.amd?define(["./picker","jquery"],a):"object"==typeof exports?module.exports=a(require("./picker.js"),require("jquery")):a(Picker,jQuery)}(function(a,b){function c(a,b){var c=this,e=a.$node[0].value,g=a.$node.data("value"),i=g||e,j=g?b.formatSubmit:b.format;c.settings=b,c.$node=a.$node,c.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"},c.item={},c.item.clear=null,c.item.interval=b.interval||30,c.item.disable=(b.disable||[]).slice(0),c.item.enable=-function(a){return!0===a[0]?a.shift():-1}(c.item.disable),c.set("min",b.min).set("max",b.max).set("now"),i?c.set("select",i,{format:j}):c.set("select",null).set("highlight",c.item.now),c.key={40:1,38:-1,39:1,37:-1,36:function(){return-c.item.highlight.pick},35:function(){return h-c.item.highlight.pick-c.item.interval},33:function(){return-f/c.item.interval},34:function(){return f/c.item.interval},go:function(a){"function"==typeof a&&(a=a()),c.set("highlight",c.item.highlight.pick+a*c.item.interval,{interval:a*c.item.interval});var e=c.item.highlight;d("Navigato a "+c.formats.toString.call(c,b.format,e)),this.render()}},a.on("render",function(){var c=a.$root.children(),d=c.find("."+b.klass.viewset),e=function(a){return["webkit","moz","ms","o",""].map(function(b){return(b?"-"+b+"-":"")+a})},f=function(a,b){e("transform").map(function(c){a.css(c,b)}),e("transition").map(function(c){a.css(c,b)})};d.length&&(f(c,"none"),c[0].scrollTop=~~d.position().top-2*d[0].clientHeight,f(c,""))},1).on("open",function(){a.$root.find("button").attr("disabled",!1),setTimeout(function(){var c=a.$root.find("."+b.klass.highlighted);c.length&&c.focus()},100)},1).on("close",function(){a.$root.find("button").attr("disabled",!0)},1)}function d(a){var b=document.getElementById("picker-live-region");b&&(b.textContent=a,setTimeout(function(){b.textContent=""},1e3))}var e=24,f=60,g=12,h=e*f,i=a._;c.prototype.set=function(a,b,c){var d=this,e=d.item;return null===b?("clear"===a&&(a="select"),e[a]=b,d):(e["enable"===a?"disable":"flip"===a?"enable":a]=d.queue[a].split(" ").map(function(e){return b=d[e](a,b,c)}).pop(),"select"===a?d.set("highlight",e.select,c):"highlight"===a?d.set("view",e.highlight,c):"interval"===a?d.set("min",e.min,c).set("max",e.max,c):a.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&d.disabled(e.select)&&d.set("select",b,c),e.highlight&&d.disabled(e.highlight)&&d.set("highlight",b,c),"min"===a&&d.set("max",e.max,c)),d)},c.prototype.get=function(a){return this.item[a]},c.prototype.create=function(a,c,d){var g=this;return c=void 0===c?a:c,i.isDate(c)&&(c=[c.getHours(),c.getMinutes()]),b.isPlainObject(c)&&i.isInteger(c.pick)?c=c.pick:Array.isArray(c)?c=+c[0]*f+ +c[1]:i.isInteger(c)||(c=g.now(a,c,d)),"max"===a&&c<g.item.min.pick&&(c+=h),"min"!==a&&"max"!==a&&(c-g.item.min.pick)%g.item.interval!=0&&(c+=g.item.interval),c=g.normalize(a,c,d),{hour:~~(e+c/f)%e,mins:(f+c%f)%f,time:(h+c)%h,pick:c%h}},c.prototype.createRange=function(a,c){var d=this,e=function(a){return!0===a||Array.isArray(a)||i.isDate(a)?d.create(a):a};return i.isInteger(a)||(a=e(a)),i.isInteger(c)||(c=e(c)),i.isInteger(a)&&b.isPlainObject(c)?a=[c.hour,c.mins+a*d.settings.interval]:i.isInteger(c)&&b.isPlainObject(a)&&(c=[a.hour,a.mins+c*d.settings.interval]),{from:e(a),to:e(c)}},c.prototype.withinRange=function(a,b){return a=this.createRange(a.from,a.to),b.pick>=a.from.pick&&b.pick<=a.to.pick},c.prototype.overlapRanges=function(a,b){var c=this;return a=c.createRange(a.from,a.to),b=c.createRange(b.from,b.to),c.withinRange(a,b.from)||c.withinRange(a,b.to)||c.withinRange(b,a.from)||c.withinRange(b,a.to)},c.prototype.now=function(a,b){var c,d=this.item.interval,e=new Date,g=e.getHours()*f+e.getMinutes(),h=i.isInteger(b);return g-=g%d,c=b<0&&d*b+g<=-d,g+="min"===a&&c?0:d,h&&(g+=d*(c&&"max"!==a?b+1:b)),g},c.prototype.normalize=function(a,b){var c=this.item.interval,d=this.item.min&&this.item.min.pick||0;return b-="min"===a?0:(b-d)%c},c.prototype.measure=function(a,c,d){var g=this;return c||(c="min"===a?[0,0]:[e-1,f-1]),"string"==typeof c?c=g.parse(a,c):!0===c||i.isInteger(c)?c=g.now(a,c,d):b.isPlainObject(c)&&i.isInteger(c.pick)&&(c=g.normalize(a,c.pick,d)),c},c.prototype.validate=function(a,b,c){var d=this,e=c&&c.interval?c.interval:d.item.interval;return d.disabled(b)&&(b=d.shift(b,e)),b=d.scope(b),d.disabled(b)&&(b=d.shift(b,-1*e)),b},c.prototype.disabled=function(a){var c=this,d=c.item.disable.filter(function(d){return i.isInteger(d)?a.hour===d:Array.isArray(d)||i.isDate(d)?a.pick===c.create(d).pick:b.isPlainObject(d)?c.withinRange(d,a):void 0});return d=d.length&&!d.filter(function(a){return Array.isArray(a)&&"inverted"===a[2]||b.isPlainObject(a)&&a.inverted}).length,-1===c.item.enable?!d:d||a.pick<c.item.min.pick||a.pick>c.item.max.pick},c.prototype.shift=function(a,b){var c=this,d=c.item.min.pick,e=c.item.max.pick;for(b=b||c.item.interval;c.disabled(a)&&(a=c.create(a.pick+=b),!(a.pick<=d||a.pick>=e)););return a},c.prototype.scope=function(a){var b=this.item.min.pick,c=this.item.max.pick;return this.create(a.pick>c?c:a.pick<b?b:a)},c.prototype.parse=function(a,b,c){var d,e,g,h,j,k=this,l={};if(!b||"string"!=typeof b)return b;c&&c.format||(c=c||{},c.format=k.settings.format),k.formats.toArray(c.format).map(function(a){var c,d=k.formats[a],e=d?i.trigger(d,k,[b,l]):a.replace(/^!/,"").length;d&&(c=b.substr(0,e),l[a]=c.match(/^\d+$/)?+c:c),b=b.substr(e)});for(h in l)j=l[h],i.isInteger(j)?h.match(/^(h|hh)$/i)?(d=j,"h"!==h&&"hh"!==h||(d%=12)):"i"===h&&(e=j):h.match(/^a$/i)&&j.match(/^p/i)&&("h"in l||"hh"in l)&&(g=!0);return(g?d+12:d)*f+e},c.prototype.formats={h:function(a,b){return a?i.digits(a):b.hour%g||g},hh:function(a,b){return a?2:i.lead(b.hour%g||g)},H:function(a,b){return a?i.digits(a):""+b.hour%24},HH:function(a,b){return a?i.digits(a):i.lead(b.hour%24)},i:function(a,b){return a?2:i.lead(b.mins)},a:function(a,b){return a?4:h/2>b.time%h?"a.m.":"p.m."},A:function(a,b){return a?2:h/2>b.time%h?"AM":"PM"},toArray:function(a){return a.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(a,b){var c=this;return c.formats.toArray(a).map(function(a){return i.trigger(c.formats[a],c,[0,b])||a.replace(/^!/,"")}).join("")}},c.prototype.isTimeExact=function(a,c){var d=this;return i.isInteger(a)&&i.isInteger(c)||"boolean"==typeof a&&"boolean"==typeof c?a===c:(i.isDate(a)||Array.isArray(a))&&(i.isDate(c)||Array.isArray(c))?d.create(a).pick===d.create(c).pick:!(!b.isPlainObject(a)||!b.isPlainObject(c))&&(d.isTimeExact(a.from,c.from)&&d.isTimeExact(a.to,c.to))},c.prototype.isTimeOverlap=function(a,c){var d=this;return i.isInteger(a)&&(i.isDate(c)||Array.isArray(c))?a===d.create(c).hour:i.isInteger(c)&&(i.isDate(a)||Array.isArray(a))?c===d.create(a).hour:!(!b.isPlainObject(a)||!b.isPlainObject(c))&&d.overlapRanges(a,c)},c.prototype.flipEnable=function(a){var b=this.item;b.enable=a||(-1===b.enable?1:-1)},c.prototype.deactivate=function(a,c){var d=this,e=d.item.disable.slice(0);return"flip"===c?d.flipEnable():!1===c?(d.flipEnable(1),e=[]):!0===c?(d.flipEnable(-1),e=[]):c.map(function(a){for(var c,f=0;f<e.length;f+=1)if(d.isTimeExact(a,e[f])){c=!0;break}c||(i.isInteger(a)||i.isDate(a)||Array.isArray(a)||b.isPlainObject(a)&&a.from&&a.to)&&e.push(a)}),e},c.prototype.activate=function(a,c){var d=this,e=d.item.disable,f=e.length;return"flip"===c?d.flipEnable():!0===c?(d.flipEnable(1),e=[]):!1===c?(d.flipEnable(-1),e=[]):c.map(function(a){var c,g,h,j;for(h=0;h<f;h+=1){if(g=e[h],d.isTimeExact(g,a)){c=e[h]=null,j=!0;break}if(d.isTimeOverlap(g,a)){b.isPlainObject(a)?(a.inverted=!0,c=a):Array.isArray(a)?(c=a,c[2]||c.push("inverted")):i.isDate(a)&&(c=[a.getFullYear(),a.getMonth(),a.getDate(),"inverted"]);break}}if(c)for(h=0;h<f;h+=1)if(d.isTimeExact(e[h],a)){e[h]=null;break}if(j)for(h=0;h<f;h+=1)if(d.isTimeOverlap(e[h],a)){e[h]=null;break}c&&e.push(c)}),e.filter(function(a){return null!=a})},c.prototype.i=function(a,b){return i.isInteger(b)&&b>0?b:this.item.interval},c.prototype.nodes=function(a){var b=this,c=b.settings,d=b.item.select,e=b.item.highlight,f=b.item.view,g=b.item.disable;return i.node("ul",i.group({min:b.item.min.pick,max:b.item.max.pick,i:b.item.interval,node:"li",item:function(a){a=b.create(a);var h=a.pick,j=d&&d.pick===h,k=e&&e.pick===h,l=g&&b.disabled(a),m=i.trigger(b.formats.toString,b,[c.format,a]),n=m;return j&&(n+=", selezionato"),l&&(n+=", non disponibile"),[i.node("button",i.trigger(b.formats.toString,b,[i.trigger(c.formatLabel,b,[a])||c.format,a]),function(a){return j&&a.push(c.klass.selected),k&&a.push(c.klass.highlighted),f&&f.pick===h&&a.push(c.klass.viewset),l&&a.push(c.klass.disabled),a.join(" ")}([c.klass.listItem]),'type="button" data-pick='+a.pick+" "+i.ariaAttr({label:n,selected:!(!j||b.$node.val()!==m)||null,disabled:!!l||null})+(l?"":' tabindex="'+(k?"0":"-1")+'"')),i.ariaAttr({role:"option"})]}})+i.node("li",i.node("button",c.clear,c.klass.buttonClear,"type=button data-clear=1"+(a?"":" disabled")+" "+i.ariaAttr({controls:b.$node[0].id,label:"Cancella selezione"})),"",i.ariaAttr({role:"presentation"})),c.klass.list,i.ariaAttr({role:"listbox",controls:b.$node[0].id,label:"Seleziona orario: usa i tasti freccia per navigare"}))},c.defaults=function(a){return{clear:"Cancella",format:"h:i A",interval:30,closeOnSelect:!0,closeOnClear:!0,updateInput:!0,klass:{picker:a+" "+a+"--time",holder:a+"__holder",list:a+"__list",listItem:a+"__list-item",disabled:a+"__list-item--disabled",selected:a+"__list-item--selected",highlighted:a+"__list-item--highlighted",viewset:a+"__list-item--viewset",now:a+"__list-item--now",buttonClear:a+"__button--clear"}}}(a.klasses().picker),a.extend("pickatime",c)});